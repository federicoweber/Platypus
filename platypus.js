// Generated by CoffeeScript 1.6.2
(function() {
  (function($) {
    var appendStyle, supportTransitions, templ_arrows, templ_bullets, templ_fullscreenBtn, templ_fullscreenHolder;

    $.fn.platypus = function(cutomOptions) {
      var bgColor, bulletsActiveColor, bulletsColor, bulletsHoverColor, bulletsSize, createGallery, fadeIn, fadeOut, options;

      if (cutomOptions == null) {
        cutomOptions = {};
      }
      options = {};
      options.fullscreen = cutomOptions.fullscreen != null ? cutomOptions.fullscreen : true;
      options.arrows = cutomOptions.arrows != null ? cutomOptions.arrows : true;
      options.initialSlide = cutomOptions.initialSlide != null ? cutomOptions.initialSlide : 0;
      options.onInit = cutomOptions.onInit != null ? cutomOptions.onInit : null;
      options.fullscreen_label = cutomOptions.fullscreen_label || 'fullscreen';
      options.zoom_label = cutomOptions.zoom_label || 'zoom';
      options.previous_label = cutomOptions.previous_label || 'previous';
      options.next_label = cutomOptions.next_label || 'next';
      bgColor = 'lightgrey';
      bulletsSize = 10;
      bulletsColor = '#fff';
      bulletsHoverColor = '#666';
      bulletsActiveColor = '#222';
      options.animationSpeed = 800;
      fadeIn = "0%{\n	transform: rotateY(0) scale(0)  translateY(-600px);\n	-ms-transform: rotateY(0) scale(0)  translateY(-600px);\n	-webkit-transform: rotateY(0) scale(0)  translateY(-600px);\n}\n20%{\n	opacity: 0.5;\n	box-shadow: rgba(0, 0, 0, 0.6) 0px 15px 30px;\n	-moz-box-shadow: rgba(0, 0, 0, 0.6) 0px 15px 30px;\n	-webkit-box-shadow: rgba(0, 0, 0, 0.6) 0px 15px 30px;\n}\n80%{\n	box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px;\n	-moz-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px;\n	-webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px;\n}\n100%{ \n	transform: rotateY(0) scaleY(1) translateY(0);\n	-ms-transform: rotateY(0) scaleY(1) translateY(0);\n	-webkit-transform: rotateY(0) scaleY(1) translateY(0);\n	opacity: 1;\n	box-shadow: rgba(0, 0, 0, 0.4) 0px 0 0;\n	-moz-box-shadow: rgba(0, 0, 0, 0.4) 0px 0 0;\n	-webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 0 0;\n}";
      fadeOut = "0%{ \n	transform: rotateY(0) scaleY(1) translateY(0);\n	-ms-transform: rotateY(0) scaleY(1) translateY(0);\n	-webkit-transform: rotateY(0) scaleY(1) translateY(0);\n	opacity: 1;\n	box-shadow: rgba(0, 0, 0, 0.4) 0px 0 0;\n	-moz-box-shadow: rgba(0, 0, 0, 0.4) 0px 0 0;\n	-webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 0 0;\n}\n20%{\n	box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px;\n	-moz-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px;\n	-webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px;\n}\n80%{\n	opacity: 0.5;\n	box-shadow: rgba(0, 0, 0, 0.6) 0px 15px 30px;\n	-moz-box-shadow: rgba(0, 0, 0, 0.6) 0px 15px 30px;\n	-webkit-box-shadow: rgba(0, 0, 0, 0.6) 0px 15px 30px;\n}\n100%{\n	transform: rotateY(0) scale(0)  translateY(-600px);\n	-ms-transform: rotateY(0) scale(0)  translateY(-600px);\n	-webkit-transform: rotateY(0) scale(0)  translateY(-600px);\n}";
      options.baseStyle = cutomOptions.baseStyle || (".platypus_Holder {\n	margin: 20px auto;\n}\n\n#platypus_fullscreen {\n	position: fixed;\n	top: 0;\n	z-index: 9999;\n	left: 0;\n	right: 0;\n	bottom: 0;\n	background: #fff;\n	background: rgba(255,255,255,.8);\n	padding-top: 5%;\n}\n\n.platypus{\n	width: 100%;\n}\n.platypus .slide {\n	margin: 0 auto; \n	display: block;\n	overflow: hidden;\n	text-align: center;\n\n	perspective: 100;\n	-ms-perspective: 100;\n	-webkit-perspective: 100;\n	height: 0;\n	opacity: 0;\n	position: relative;\n	\n}\n.platypus .slide.active {\n	display: table;\n	opacity: 1;\n	height: auto;\n	overflow: visible;\n\n	animation: platypus_fadeIn 800ms cubic-bezier(0.215, 0.61, 0.355, 1);\n	-ms-animation: platypus_fadeIn 800ms cubic-bezier(0.215, 0.61, 0.355, 1);\n	-webkit-animation: platypus_fadeIn 800ms cubic-bezier(0.215, 0.61, 0.355, 1);\n\n	transform: rotateY(0) scaleY(1) translateY(0);\n	-ms-transform: rotateY(0) scaleY(1) translateY(0);\n	-webkit-transform: rotateY(0) scaleY(1) translateY(0);\n}\n\n.platypus .slide.hide {\n	animation: platypus_fadeOut 600ms cubic-bezier(0.215, 0.61, 0.355, 1);\n	-ms-animation: platypus_fadeOut 600ms cubic-bezier(0.215, 0.61, 0.355, 1);\n	-webkit-animation: platypus_fadeOut 600ms cubic-bezier(0.215, 0.61, 0.355, 1);\n	\n	transform: rotateY(0) scale(0)  translateY(-600px);\n	-ms-transform: rotateY(0) scale(0)  translateY(-600px);\n	-webkit-transform: rotateY(0) scale(0)  translateY(-600px);\n\n	height: 0;\n	opacity: 0;\n}\n\n@-webkit-keyframes platypus_fadeIn {" + fadeIn + "}\n@-moz-keyframes platypus_fadeIn {" + fadeIn + "}\n@-ms-keyframes platypus_fadeIn {" + fadeIn + "}\n@-o-keyframes platypus_fadeIn {" + fadeIn + "}\n\n@-webkit-keyframes platypus_fadeOut {" + fadeOut + "}\n@-moz-keyframes platypus_fadeOut {" + fadeOut + "}\n@-ms-keyframes platypus_fadeOut {" + fadeOut + "}\n@-o-keyframes platypus_fadeOut {" + fadeIn + "}\n\n.platypus .slide.fadeOut {\n}\n.platypus .slide figure {\n	width: 100%;\n}\n.platypus .slide figure img {\n	width: 100%;\n	max-width: 100%;\n	display: block;\n}\n.platypus .slide figure figcaption {\n	background: " + bgColor + ";\n	padding: 20px 0 40px 0;\n}\n.platypus .slide .platypus_fullscreenBtn{\n	position: relative;\n	top: 22px;\n	float: right;\n}\n\n.platypus_nav{\n	padding: 20px 0;\n	# background: " + bgColor + ";\n	margin: 0 auto;\n	top: -45px;\n	position: relative;\n}\n.platypus_arrowsHolder{\n	margin: 0 auto;\n	margin-top: 0;\n	position: absolute;\n	top: 50%;\n	width: 100%\n}\n.platypus_arrow.platypus_prevBtn {\n	float: left;\n}\n.platypus_arrow.platypus_nextBtn {\n	float: right;\n}\n.platypus_bullets{\n	display: table;\n	margin: 0 auto;\n}\n.platypus_bullets .platypus_bullet{\n	cursor: pointer;\n	display: block;\n	width: " + bulletsSize + "px;\n	height: " + bulletsSize + "px;\n	margin-right: " + (bulletsSize / 2) + "px;\n	background: " + bulletsColor + ";\n	float: left;\n	-webkit-border-radius: 50%;\n	-moz-border-radius: 50%;\n	border-radius: 50%;\n}\n.platypus_bullets .platypus_bullet:last-child{\n	margin-right: 0;\n}\n.platypus_bullets .platypus_bullet:hover{\n	background: " + bulletsHoverColor + ";\n}\n.platypus_bullets .platypus_bullet.active{\n	background: " + bulletsActiveColor + ";\n}");
      createGallery = function(options) {
        var $el, $wrapper, addInterface, bindActions, fullscreen, galleryId, navigateTo, originalHtml;

        $el = $(this);
        $el.wrap("<div class='platypus_Holder'>");
        $wrapper = $el.parent();
        originalHtml = $wrapper.html();
        galleryId = _.uniqueId('platypus_');
        $el.attr('id', galleryId);
        $el.find('li').each(function(ind) {
          return $(this).addClass('slide').attr('id', "" + galleryId + "_" + ind);
        });
        addInterface = function() {
          var ids;

          if (options.fullscreen) {
            $el.find('li').prepend(templ_fullscreenBtn(options));
            ids = _.map($el.find('.slide').toArray(), function(el) {
              return $(el).attr('id');
            });
            if (ids.length > 1) {
              $wrapper.append(templ_bullets({
                ids: ids
              }));
              if (options.arrows) {
                return _.each($el.find('.slide').toArray(), function(el) {
                  return $(el).append(templ_arrows(options));
                });
              }
            }
          }
        };
        navigateTo = function(id) {
          galleryId = $(this).attr('id');
          $(this).find('.slide.active').addClass('hide');
          $(this).find('.slide').removeClass('active');
          $(this).parent().find('.platypus_bullet').removeClass('active');
          $("#" + galleryId + "_" + id).removeClass('hide').addClass('active');
          return $("#" + (galleryId.replace('platypus_', 'platypus_bullet_')) + "_" + id).addClass('active');
        };
        fullscreen = function() {
          var currentId, fOptions;

          currentId = Number($(this).find('.slide.active').attr('id').split('_').pop());
          $('body').append(templ_fullscreenHolder({
            gallery: originalHtml
          }));
          fOptions = options;
          fOptions.initialSlide = currentId;
          return $('#platypus_fullscreen > .platypus').platypus(fOptions);
        };
        bindActions = function() {
          var that;

          that = this;
          $wrapper.on('click', '.platypus_bullet', function() {
            return navigateTo.call(that, $(this).attr('id').split('_').pop());
          });
          $wrapper.on('click', '.platypus_arrow', function() {
            var currentId, direction, target;

            direction = $(this).hasClass('platypus_prevBtn') ? -1 : 1;
            currentId = Number($(that).find('.slide.active').attr('id').split('_').pop());
            if (currentId === 0) {
              currentId = $(that).find('.slide').length;
            }
            target = (currentId + direction) % $(that).find('.slide').length;
            return navigateTo.call(that, target);
          });
          return $wrapper.on('click', '.platypus_fullscreenBtn', function() {
            if ($(that).parent().parent().attr('id') !== 'platypus_fullscreen') {
              return fullscreen.call(that);
            } else {
              return $(that).parent().parent().remove();
            }
          });
        };
        addInterface.call(this);
        bindActions.call(this);
        navigateTo.call(this, options.initialSlide);
        if (options.onInit != null) {
          options.onInit();
        }
        return this;
      };
      appendStyle(options.baseStyle);
      return this.each(function() {
        return createGallery.call(this, options);
      });
    };
    appendStyle = function(style) {
      if (!$('#platypus_Style').length) {
        return $("<style type='text/css' id='platypus_Style'>" + style + "</style>").prependTo($('head'));
      }
    };
    supportTransitions = function() {};
    templ_fullscreenHolder = _.template("<div id='platypus_fullscreen'>\n	<%= gallery %>\n</div>");
    templ_fullscreenBtn = _.template("<button class='platypus_fullscreenBtn' type=\"button\"><%- fullscreen_label %></button>");
    templ_bullets = _.template("<div class='platypus_nav'>\n	<ul class='platypus_bullets'>\n		<% _.each(ids, function(id){ %>\n			<li class='platypus_bullet' id='<%= id.replace('platypus', 'platypus_bullet') %>' data-target='<%= id %>'> </li>\n		<% }) %>\n	</ul>\n</div>");
    return templ_arrows = _.template("<div class='platypus_arrowsHolder'>\n	<button class='platypus_arrow platypus_prevBtn' type=\"button\"><%- previous_label %></button>\n	<button class='platypus_arrow platypus_nextBtn' type=\"button\"><%- next_label %></button>\n</div>");
  })(jQuery);

}).call(this);
